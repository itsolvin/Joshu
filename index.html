<!doctype html>
<html lang="ne">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="assets/Fav.png" />
    <title>‡§π‡§æ‡§Æ‡•ç‡§∞‡•ã ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ (Our Journey)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Anton&family=Gotu&family=Lora:ital,wght@0,400;0,600;1,400&family=Oswald:wght@300;500&family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
  </head>

  <body>
    <div id="toast-container"></div>
    <!-- AUDIO ELEMENT (Hidden) -->
    <!-- GLOBAL AUDIO PLAYER -->
    <div id="audioPlayer" class="audio-player">
      <button id="playBtn" class="control-btn" aria-label="Play">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
          <path
            d="M3 1.713a.7.7 0 0 1 1.05-.607l10.89 6.288a.7.7 0 0 1 0 1.212L4.05 14.894A.7.7 0 0 1 3 14.288V1.713z"
          />
        </svg>
      </button>
      <div class="volume-control">
        <svg
          class="volume-icon"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="currentColor"
        >
          <path
            d="M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"
          />
          <path
            d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"
          />
          <path
            d="M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"
          />
        </svg>
        <input
          type="range"
          id="volumeSlider"
          min="0"
          max="1"
          step="0.01"
          value="0.02"
        />
      </div>
    </div>

    <!-- MAIN SPLIT CONTAINER -->
    <main class="split-layout">
      <!-- LEFT PANEL: Film Strip -->
      <aside class="film-strip-panel" id="filmStrip">
        <div class="film-strip-track" id="filmTrack">
          <!-- Items injected by JS -->
        </div>

        <!-- Decorations -->
        <div class="sprocket-holes-left"></div>
        <div class="sprocket-holes-right"></div>

        <!-- Relocated Add Album Button -->
        <button
          id="addPhotoBtn"
          class="add-album-floating-btn"
          style="display: none"
          title="Add Album"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          <span>Add Album</span>
        </button>
      </aside>

      <!-- RIGHT PANEL: The Stage -->
      <section class="stage-panel" id="rightPanel">
        <div class="stage-bg-layer" id="stageBg"></div>
        <div class="stage-overlay"></div>

        <div class="stage-content" id="stageContent">
          <h1 class="stage-title">...</h1>
          <p class="stage-desc">...</p>
          <div class="stage-meta">...</div>
          <div class="hint-text">Click to Open Memory</div>
        </div>
      </section>
    </main>

    <!-- MOBILE NAVIGATION CONTROLS -->
    <div class="mobile-nav" id="mobileNav">
      <button class="nav-arrow nav-prev" id="prevBtn">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="progress-dots" id="progressDots">
        <!-- Dots injected by JS -->
      </div>

      <button class="nav-arrow nav-next" id="nextBtn">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <!-- FULLSCREEN MEMORY OVERLAY -->
    <section id="fullscreenOverlay" class="fullscreen-memory">
      <button id="closeFsBtn" class="back-btn">‚Üê Back</button>
      <button
        id="addPolaroidBtn"
        class="add-polaroid-btn"
        style="display: none"
      >
        + Add Photo
      </button>

      <div class="fs-hero">
        <h1 class="fs-title">Title</h1>
        <p class="fs-desc">Description</p>
      </div>

      <div class="polaroid-grid" id="polaroidGrid">
        <!-- Polaroids injected here -->
      </div>
    </section>

    <!-- ADMIN CONTROLS -->
    <div id="adminControls">
      <button id="authBtn" class="login-trigger" title="Admin Login">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
      </button>
      <button
        id="logoutBtn"
        class="logout-btn"
        style="display: none"
        title="Logout"
      >
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
      </button>
      <input
        type="file"
        id="photoUpload"
        accept="image/*"
        style="display: none"
      />
    </div>

    <!-- LOGIN MODAL -->
    <div id="loginModal" class="modal">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Admin Login</h2>
        <form id="loginForm">
          <input type="email" id="adminEmail" placeholder="Email" />
          <input type="password" id="adminPass" placeholder="Password" />
          <button type="submit" id="loginSubmitBtn">Login</button>
        </form>
      </div>
    </div>

    <!-- CREATE MEMORY MODAL -->
    <div id="createMemoryModal" class="modal">
      <div
        class="modal-content"
        style="width: 90%; max-width: 400px; text-align: left"
      >
        <span class="close-modal" id="closeCreateModal">&times;</span>
        <h2 style="text-align: center; margin-bottom: 20px">New Memory</h2>

        <label for="newMemTitle" style="color: #aaa; font-size: 0.9em"
          >Title</label
        >
        <input
          type="text"
          id="newMemTitle"
          placeholder="e.g. Summer Trip 2026"
        />

        <label for="newMemDate" style="color: #aaa; font-size: 0.9em"
          >Date</label
        >
        <input type="text" id="newMemDate" placeholder="e.g. July 2026" />

        <label for="newMemDesc" style="color: #aaa; font-size: 0.9em"
          >Description</label
        >
        <textarea
          id="newMemDesc"
          rows="3"
          placeholder="A beautiful moment..."
          style="
            width: 100%;
            background: #2a2a2a;
            color: #fff;
            border: 1px solid #333;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0 15px;
            font-family: inherit;
            resize: vertical;
          "
        ></textarea>

        <!-- New: Theme Color UI -->
        <label
          style="
            color: #aaa;
            font-size: 0.9em;
            display: block;
            margin-bottom: 8px;
          "
          >Theme Color</label
        >
        <div
          class="color-picker-container"
          style="display: flex; gap: 10px; margin-bottom: 20px"
        >
          <!-- Presets -->
          <div
            class="color-option selected"
            data-value="#d13030"
            style="background: #d13030"
          ></div>
          <div
            class="color-option"
            data-value="#2ecc71"
            style="background: #2ecc71"
          ></div>
          <div
            class="color-option"
            data-value="#3498db"
            style="background: #3498db"
          ></div>
          <div
            class="color-option"
            data-value="#9b59b6"
            style="background: #9b59b6"
          ></div>
          <div
            class="color-option"
            data-value="#f1c40f"
            style="background: #f1c40f"
          ></div>
          <!-- Custom Input Trigger -->
          <div
            class="color-option custom-trigger"
            style="
              background: linear-gradient(45deg, red, blue);
              position: relative;
            "
          >
            <input
              type="color"
              id="newMemColor"
              value="#d13030"
              style="
                opacity: 0;
                position: absolute;
                width: 100%;
                height: 100%;
                cursor: pointer;
              "
            />
          </div>
        </div>

        <!-- New: Enhanced Music Selection UI -->
        <label
          style="
            color: #aaa;
            font-size: 0.9em;
            display: block;
            margin-bottom: 8px;
          "
          >Background Music</label
        >
        <div
          class="music-selection-container"
          style="
            background: #222;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            margin-bottom: 20px;
          "
        >
          <!-- Custom Select -->
          <div
            class="custom-select-wrapper"
            style="position: relative; margin-bottom: 12px"
          >
            <select
              id="newMemAudio"
              style="
                width: 100%;
                background: #000;
                color: #fff;
                border: 1px solid #444;
                padding: 10px 15px;
                border-radius: 6px;
                appearance: none;
                cursor: pointer;
              "
            >
              <option value="assets/audio/sparkle.mp3">
                Sparkle (Default)
              </option>
              <option value="assets/Lifetogether.mp3">Life Together</option>
              <option value="assets/Quite.mp3">Quiet Days</option>
              <option value="assets/Food.mp3">Food</option>
              <option value="assets/Trip.mp3">Trip</option>
              <option value="assets/datess.mp3">Datess</option>
              <option value="assets/Roadtrip.mp3">Roadtrip</option>
            </select>
            <div
              style="
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
                pointer-events: none;
                color: #aaa;
              "
            >
              ‚ñº
            </div>
          </div>

          <div
            style="
              text-align: center;
              font-size: 0.8em;
              color: #555;
              margin: 8px 0;
            "
          >
            ‚Äî OR ‚Äî
          </div>

          <!-- Custom File Upload -->
          <div class="file-upload-wrapper" style="text-align: center">
            <label
              for="newMemAudioFile"
              class="custom-file-label"
              style="
                display: inline-block;
                background: #333;
                color: #fff;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 0.85em;
                cursor: pointer;
                transition: background 0.2s;
                border: 1px solid #444;
              "
            >
              üéµ Upload Custom MP3
            </label>
            <input
              type="file"
              id="newMemAudioFile"
              accept="audio/mpeg, audio/mp3, audio/*"
              style="display: none"
            />
            <div
              id="audioFileName"
              style="
                margin-top: 5px;
                font-size: 0.8em;
                color: #aaa;
                font-style: italic;
              "
            >
              No file chosen
            </div>
          </div>
        </div>

        <button id="createMemBtn" style="margin-top: 10px; background: #000">
          Select Photo & Create
        </button>
      </div>
    </div>

    <!-- CUSTOM CONFIRMATION MODAL -->
    <div id="confirmModal" class="modal" style="z-index: 10001">
      <div class="modal-content" style="max-width: 400px; text-align: center">
        <h3 id="confirmTitle" style="margin-bottom: 15px">Are you sure?</h3>
        <p id="confirmMessage" style="color: #aaa; margin-bottom: 25px">
          This action cannot be undone.
        </p>

        <div style="display: flex; gap: 10px; justify-content: center">
          <button id="confirmCancelBtn" style="background: #333; flex: 1">
            Cancel
          </button>
          <button id="confirmOkBtn" style="background: #d13030; flex: 1">
            Delete
          </button>
        </div>
      </div>
    </div>

    <!-- CUSTOM PROMPT MODAL -->
    <div id="promptModal" class="modal" style="z-index: 10002">
      <div class="modal-content" style="max-width: 400px; text-align: center">
        <h3 id="promptTitle" style="margin-bottom: 15px">Enter Caption</h3>
        <p
          id="promptMessage"
          style="
            color: #aaa;
            margin-bottom: 15px;
            font-size: 0.9em;
            display: none;
          "
        ></p>

        <input
          type="text"
          id="promptInput"
          style="
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            background: #333;
            border: 1px solid #444;
            color: #fff;
            border-radius: 4px;
          "
          placeholder="Type here..."
        />

        <div style="display: flex; gap: 10px; justify-content: center">
          <button id="promptCancelBtn" style="background: #333; flex: 1">
            Cancel
          </button>
          <button id="promptOkBtn" style="background: #4caf50; flex: 1">
            OK
          </button>
        </div>
      </div>
    </div>

    <!-- EDIT MEMORY MODAL (Cloned & Modified) -->
    <div id="editMemoryModal" class="modal">
      <div
        class="modal-content"
        style="width: 90%; max-width: 400px; text-align: left"
      >
        <span class="close-modal" id="closeEditModal">&times;</span>
        <h2 style="text-align: center; margin-bottom: 20px">Edit Memory</h2>
        <input type="hidden" id="editMemId" />

        <label for="editMemTitle" style="color: #aaa; font-size: 0.9em"
          >Title</label
        >
        <input type="text" id="editMemTitle" placeholder="Memory Title" />

        <label for="editMemDate" style="color: #aaa; font-size: 0.9em"
          >Date</label
        >
        <input type="text" id="editMemDate" placeholder="Date" />

        <label for="editMemDesc" style="color: #aaa; font-size: 0.9em"
          >Description</label
        >
        <textarea
          id="editMemDesc"
          rows="3"
          placeholder="Description..."
          style="
            width: 100%;
            background: #2a2a2a;
            color: #fff;
            border: 1px solid #333;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0 15px;
            font-family: inherit;
            resize: vertical;
          "
        ></textarea>

        <!-- Theme Color UI -->
        <label
          style="
            color: #aaa;
            font-size: 0.9em;
            display: block;
            margin-bottom: 8px;
          "
          >Theme Color</label
        >
        <div
          class="color-picker-container edit-color-container"
          style="display: flex; gap: 10px; margin-bottom: 20px"
        >
          <div
            class="color-option edit-color-option"
            data-value="#d13030"
            style="background: #d13030"
          ></div>
          <div
            class="color-option edit-color-option"
            data-value="#2ecc71"
            style="background: #2ecc71"
          ></div>
          <div
            class="color-option edit-color-option"
            data-value="#3498db"
            style="background: #3498db"
          ></div>
          <div
            class="color-option edit-color-option"
            data-value="#9b59b6"
            style="background: #9b59b6"
          ></div>
          <div
            class="color-option edit-color-option"
            data-value="#f1c40f"
            style="background: #f1c40f"
          ></div>
          <div
            class="color-option edit-color-option custom-trigger"
            style="
              background: linear-gradient(45deg, red, blue);
              position: relative;
            "
          >
            <input
              type="color"
              id="editMemColor"
              style="
                opacity: 0;
                position: absolute;
                width: 100%;
                height: 100%;
                cursor: pointer;
              "
            />
          </div>
        </div>

        <!-- Music Selection UI -->
        <label
          style="
            color: #aaa;
            font-size: 0.9em;
            display: block;
            margin-bottom: 8px;
          "
          >Background Music</label
        >
        <div
          class="music-selection-container"
          style="
            background: #222;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            margin-bottom: 20px;
          "
        >
          <div
            class="custom-select-wrapper"
            style="position: relative; margin-bottom: 12px"
          >
            <select
              id="editMemAudio"
              style="
                width: 100%;
                background: #000;
                color: #fff;
                border: 1px solid #444;
                padding: 10px 15px;
                border-radius: 6px;
                appearance: none;
                cursor: pointer;
              "
            >
              <option value="assets/audio/sparkle.mp3">
                Sparkle (Default)
              </option>
              <option value="assets/Lifetogether.mp3">Life Together</option>
              <option value="assets/Quite.mp3">Quiet Days</option>
              <option value="assets/Food.mp3">Food</option>
              <option value="assets/Trip.mp3">Trip</option>
              <option value="assets/datess.mp3">Datess</option>
              <option value="assets/Roadtrip.mp3">Roadtrip</option>
            </select>
            <div
              style="
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
                pointer-events: none;
                color: #aaa;
              "
            >
              ‚ñº
            </div>
          </div>
          <div
            style="
              text-align: center;
              font-size: 0.8em;
              color: #555;
              margin: 8px 0;
            "
          >
            ‚Äî OR ‚Äî
          </div>
          <div class="file-upload-wrapper" style="text-align: center">
            <label
              for="editMemAudioFile"
              class="custom-file-label"
              style="
                display: inline-block;
                background: #333;
                color: #fff;
                padding: 8px 16px;
                border-radius: 20px;
                font-size: 0.85em;
                cursor: pointer;
                transition: background 0.2s;
                border: 1px solid #444;
              "
            >
              üéµ Change MP3
            </label>
            <input
              type="file"
              id="editMemAudioFile"
              accept="audio/mpeg, audio/mp3, audio/*"
              style="display: none"
            />
            <div
              id="editAudioFileName"
              style="
                margin-top: 5px;
                font-size: 0.8em;
                color: #aaa;
                font-style: italic;
              "
            >
              No new file
            </div>
          </div>
        </div>

        <button
          id="saveMemChangesBtn"
          style="margin-top: 10px; background: #000"
        >
          Save Changes
        </button>
      </div>
    </div>

    <script type="module" src="script.js"></script>
  </body>
</html>
